<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ZeroSend â€” Frontend é–‹ç™ºé€²æ—</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --brand: #4f46e5;
    --brand-light: #eef2ff;
    --brand-mid: #818cf8;
    --bg: #f4f4f8;
    --surface: #ffffff;
    --border: #e5e7eb;
    --text: #111827;
    --muted: #6b7280;
    --done: #059669;
    --done-bg: #d1fae5;
    --wip: #d97706;
    --wip-bg: #fef3c7;
    --hold: #dc2626;
    --hold-bg: #fee2e2;
    --todo-bg: #f3f4f6;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Noto Sans JP', sans-serif;
    background: var(--bg);
    color: var(--text);
    font-size: 13px;
    line-height: 1.5;
  }
  /* â”€â”€ ãƒ˜ãƒƒãƒ€ãƒ¼ â”€â”€ */
  .header {
    position: sticky; top: 0; z-index: 100;
    background: rgba(255,255,255,0.96);
    backdrop-filter: blur(8px);
    border-bottom: 1px solid var(--border);
    padding: 14px 24px 10px;
    box-shadow: 0 1px 6px rgba(79,70,229,0.06);
  }
  .header-top { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
  .logo { display: flex; align-items: center; gap: 10px; }
  .logo-icon {
    width: 32px; height: 32px; border-radius: 8px;
    background: linear-gradient(135deg, #6366f1, #8b5cf6);
    display: flex; align-items: center; justify-content: center;
    color: #fff; font-size: 15px; box-shadow: 0 2px 8px rgba(99,102,241,0.3);
  }
  .logo-title { font-weight: 700; font-size: 15px; letter-spacing: -0.3px; }
  .logo-sub { font-size: 10px; font-family: 'DM Mono', monospace; color: var(--brand); background: var(--brand-light); padding: 2px 8px; border-radius: 99px; border: 1px solid #c7d2fe; }
  .stats { display: flex; align-items: center; gap: 16px; }
  .stat-pct { font-size: 26px; font-weight: 700; color: var(--brand); font-family: 'DM Mono', monospace; line-height: 1; }
  .stat-label { font-size: 10px; color: var(--muted); margin-top: 2px; }
  /* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ */
  .progress-bar-wrap { height: 5px; background: #e0e7ff; border-radius: 99px; overflow: hidden; margin-bottom: 10px; }
  .progress-bar-fill { height: 100%; border-radius: 99px; background: linear-gradient(90deg, #6366f1, #8b5cf6, #a78bfa); transition: width 0.4s ease; }
  /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ */
  .filters { display: flex; gap: 6px; flex-wrap: wrap; }
  .filter-btn {
    padding: 3px 12px; border-radius: 99px; font-size: 11px; font-weight: 600;
    border: 1.5px solid var(--border); background: #fff; color: var(--muted);
    cursor: pointer; transition: all 0.15s;
  }
  .filter-btn:hover { border-color: var(--brand-mid); color: var(--brand); }
  .filter-btn.active { background: var(--brand); color: #fff; border-color: var(--brand); }
  /* â”€â”€ ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ â”€â”€ */
  .main { max-width: 1100px; margin: 0 auto; padding: 20px 20px 40px; }
  /* â”€â”€ ãƒ•ã‚§ãƒ¼ã‚ºãƒ–ãƒ­ãƒƒã‚¯ â”€â”€ */
  .phase { border-radius: 14px; border: 1.5px solid; margin-bottom: 12px; overflow: hidden; transition: box-shadow 0.2s; }
  .phase:hover { box-shadow: 0 4px 20px rgba(0,0,0,0.07); }
  .phase-header {
    display: flex; align-items: center; justify-content: space-between;
    padding: 12px 18px; cursor: pointer; user-select: none;
    transition: background 0.15s;
  }
  .phase-header:hover { filter: brightness(0.97); }
  .phase-left { display: flex; align-items: center; gap: 10px; }
  .phase-badge { font-size: 10px; font-weight: 700; color: #fff; padding: 2px 9px; border-radius: 99px; font-family: 'DM Mono', monospace; }
  .phase-name { font-weight: 700; font-size: 13px; }
  .phase-count { font-size: 11px; font-family: 'DM Mono', monospace; }
  .phase-right { display: flex; align-items: center; gap: 10px; }
  .phase-mini-bar { width: 80px; height: 4px; border-radius: 99px; background: rgba(255,255,255,0.4); overflow: hidden; }
  .phase-mini-fill { height: 100%; border-radius: 99px; transition: width 0.3s; }
  .chevron { font-size: 11px; color: inherit; opacity: 0.5; transition: transform 0.2s; }
  .chevron.open { transform: rotate(180deg); }
  /* â”€â”€ ãƒ†ãƒ¼ãƒ–ãƒ« â”€â”€ */
  .phase-table { width: 100%; border-collapse: collapse; }
  .phase-table thead th {
    padding: 6px 10px; text-align: left;
    font-size: 9px; font-weight: 700; letter-spacing: 0.06em; text-transform: uppercase;
    color: var(--muted); background: rgba(255,255,255,0.5); border-bottom: 1px solid rgba(0,0,0,0.06);
  }
  .phase-table tbody tr { border-bottom: 1px solid rgba(0,0,0,0.04); transition: background 0.1s; }
  .phase-table tbody tr:last-child { border-bottom: none; }
  .phase-table tbody tr:hover { background: rgba(255,255,255,0.7); }
  .phase-table tbody td { padding: 8px 10px; vertical-align: top; }
  .task-id { font-family: 'DM Mono', monospace; font-size: 10px; font-weight: 500; color: var(--muted); background: rgba(0,0,0,0.05); padding: 2px 6px; border-radius: 5px; white-space: nowrap; }
  .task-title { font-weight: 600; font-size: 12px; line-height: 1.4; }
  .task-detail { font-size: 11px; color: var(--muted); line-height: 1.5; }
  .task-api { font-family: 'DM Mono', monospace; font-size: 10px; color: var(--brand); background: var(--brand-light); padding: 2px 6px; border-radius: 5px; display: inline-block; line-height: 1.4; }
  .task-screen { font-family: 'DM Mono', monospace; font-size: 10px; color: var(--muted); }
  /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚»ãƒ¬ã‚¯ãƒˆ */
  .status-select {
    font-size: 10px; font-weight: 600; border: none; border-radius: 99px;
    padding: 3px 8px; cursor: pointer; outline: none; appearance: none;
    -webkit-appearance: none; text-align: center; width: 64px;
  }
  .status-todo   { background: var(--todo-bg); color: #374151; }
  .status-wip    { background: var(--wip-bg);  color: var(--wip); }
  .status-done   { background: var(--done-bg); color: var(--done); }
  .status-hold   { background: var(--hold-bg); color: var(--hold); }
  /* â”€â”€ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ â”€â”€ */
  .stack-card { background: #fff; border: 1.5px solid var(--border); border-radius: 14px; padding: 18px 20px; margin-top: 12px; }
  .stack-card h2 { font-size: 13px; font-weight: 700; margin-bottom: 12px; color: var(--text); }
  .stack-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px 32px; }
  .stack-item { display: flex; gap: 8px; font-size: 11px; }
  .stack-key { color: var(--muted); flex-shrink: 0; }
  .stack-val { font-family: 'DM Mono', monospace; font-weight: 500; color: var(--brand); }
  /* â”€â”€ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ³¨æ„æ›¸ã â”€â”€ */
  .security-card { background: #fffbeb; border: 1.5px solid #fcd34d; border-radius: 14px; padding: 14px 18px; margin-top: 12px; }
  .security-card h3 { font-size: 12px; font-weight: 700; color: #92400e; margin-bottom: 8px; }
  .security-card ul { padding-left: 14px; }
  .security-card li { font-size: 11px; color: #78350f; line-height: 1.7; }
  /* â”€â”€ ä¿å­˜ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ â”€â”€ */
  .save-toast {
    position: fixed; bottom: 20px; right: 20px;
    background: #111827; color: #fff; font-size: 11px; font-weight: 500;
    padding: 8px 16px; border-radius: 99px; font-family: 'DM Mono', monospace;
    opacity: 0; transform: translateY(8px);
    transition: opacity 0.2s, transform 0.2s;
    pointer-events: none; z-index: 999;
  }
  .save-toast.show { opacity: 1; transform: translateY(0); }
  /* â”€â”€ ã‚«ãƒ©ãƒ å¹… â”€â”€ */
  .col-id     { width: 52px; }
  .col-title  { width: 22%; }
  .col-detail { width: 38%; }
  .col-api    { width: 18%; }
  .col-screen { width: 10%; }
  .col-status { width: 68px; }
  /* hidden */
  .phase-body.hidden { display: none; }
</style>
</head>
<body>

<!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
<div class="header">
  <div class="header-top">
    <div class="logo">
      <div class="logo-icon">ğŸ”</div>
      <div>
        <div class="logo-title">ZeroSend</div>
      </div>
      <span class="logo-sub">Frontend é–‹ç™ºé€²æ—ç®¡ç†</span>
    </div>
    <div class="stats">
      <div>
        <div class="stat-pct" id="pct-display">0%</div>
        <div class="stat-label" id="stat-label">0/48 å®Œäº†</div>
      </div>
    </div>
  </div>
  <div class="progress-bar-wrap">
    <div class="progress-bar-fill" id="global-bar" style="width:0%"></div>
  </div>
  <div class="filters" id="filters">
    <button class="filter-btn active" data-filter="all" onclick="setFilter(this,'all')">ã™ã¹ã¦</button>
    <button class="filter-btn" data-filter="æœªç€æ‰‹" onclick="setFilter(this,'æœªç€æ‰‹')">æœªç€æ‰‹</button>
    <button class="filter-btn" data-filter="é€²è¡Œä¸­" onclick="setFilter(this,'é€²è¡Œä¸­')">é€²è¡Œä¸­</button>
    <button class="filter-btn" data-filter="å®Œäº†" onclick="setFilter(this,'å®Œäº†')">å®Œäº†</button>
    <button class="filter-btn" data-filter="ä¿ç•™" onclick="setFilter(this,'ä¿ç•™')">ä¿ç•™</button>
  </div>
</div>

<div class="main" id="main"></div>
<div class="save-toast" id="toast">ğŸ’¾ ä¿å­˜ã—ã¾ã—ãŸ</div>

<script>
const PHASES = [
  { id:'P0', label:'Phase 0', name:'åŸºç›¤æ§‹ç¯‰', badge:'#475569', bg:'#f8fafc', border:'#cbd5e1', textColor:'#334155',
    tasks:[
      { id:'F-01', title:'Vite + React 19 + TypeScript ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–', detail:'frontend/ ã« pnpm create vite@latestã€‚tsconfig strictãƒ»path alias (@/) è¨­å®šã€‚', api:'â€”', screen:'â€”' },
      { id:'F-02', title:'Tailwind CSS v4 + shadcn/ui ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—', detail:'ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ã® brand ã‚«ãƒ©ãƒ¼ãƒ»font (Noto Sans JP / DM Mono) ã‚’ãƒ†ãƒ¼ãƒã«åæ˜ ã€‚', api:'â€”', screen:'å…¨ç”»é¢' },
      { id:'F-03', title:'ç’°å¢ƒå¤‰æ•° (.env.local) è¨­å®š', detail:'VITE_API_BASE_URL=http://localhost:8000/api/v1ã€‚æœ¬ç•ªç”¨ .env.productionã€‚', api:'â€”', screen:'â€”' },
      { id:'F-04', title:'APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåŸºç›¤ (ky)', detail:'baseURLãƒ»JWT Authorization ãƒ˜ãƒƒãƒ€ãƒ¼è‡ªå‹•ä»˜ä¸ãƒ»401 è‡ªå‹•ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒ»ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹å®šç¾©ã€‚', api:'å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ', screen:'â€”' },
      { id:'F-05', title:'TypeScript å‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«', detail:'ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ API ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å¯¾å¿œã™ã‚‹å‹ã‚’ src/types/ ã«é›†ç´„ã€‚Prisma ã‚¹ã‚­ãƒ¼ãƒã¨æ•´åˆã€‚', api:'â€”', screen:'â€”' },
      { id:'F-06', title:'Zustand ã‚¹ãƒˆã‚¢é››å½¢', detail:'authStore (JWT/user)ãƒ»transferStore (é€ä¿¡ãƒ•ãƒ­ãƒ¼ state)ãƒ»keyStore (Kyber keypair)ã€‚', api:'â€”', screen:'â€”' },
      { id:'F-07', title:'React Router v7 ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®š', detail:'/ (é€ä¿¡) / /list / /admin / /download/:token / /login ã®5ãƒ«ãƒ¼ãƒˆã€‚ProtectedRoute HOCã€‚', api:'â€”', screen:'å…¨ç”»é¢' },
      { id:'F-08', title:'å…±é€šãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼', detail:'ãƒ­ã‚´ãƒ»Quantum-Safe ãƒãƒƒã‚¸ãƒ»ç”»é¢ã‚¿ãƒ–ãƒ»ML-KEM-768 ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ãƒã‚¿ãƒ¼ã€‚', api:'â€”', screen:'å…¨ç”»é¢' },
      { id:'F-09', title:'IndexedDB ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ (æš—å·éµæ°¸ç¶šåŒ–)', detail:'idb-keyvalã€‚Kyber ç§˜å¯†éµã‚’ userId ã‚’ã‚­ãƒ¼ã«ä¿å­˜/å–å¾—/å‰Šé™¤ã€‚', api:'â€”', screen:'â€”' },
      { id:'F-10', title:'TanStack Query ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— & QueryClient', detail:'staleTimeãƒ»retryãƒ»onError ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®šã€‚Devtools ã¯é–‹ç™ºç’°å¢ƒã®ã¿ã€‚', api:'â€”', screen:'â€”' },
    ]},
  { id:'P1', label:'Phase 1', name:'èªè¨¼ãƒ»éµç®¡ç†', badge:'#7c3aed', bg:'#faf5ff', border:'#ddd6fe', textColor:'#5b21b6',
    tasks:[
      { id:'F-11', title:'ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ UI', detail:'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›ã€‚ZeroSend ãƒ­ã‚´ãƒ»Quantum-Safe ãƒãƒƒã‚¸è¡¨ç¤ºã€‚', api:'POST /auth/login', screen:'/login' },
      { id:'F-12', title:'JWT å–å¾—ãƒ»ã‚¹ãƒˆã‚¢ç®¡ç†ãƒ»è‡ªå‹•ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥', detail:'access_token ã‚’ Zustand ã«ä¿å­˜ã€‚æœ‰åŠ¹æœŸé™ 8h å‰ã«å†ãƒ­ã‚°ã‚¤ãƒ³èª˜å°ã€‚', api:'POST /auth/login', screen:'/login' },
      { id:'F-13', title:'ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ç”»é¢ + ML-KEM-768 éµãƒšã‚¢ç”Ÿæˆ', detail:'@noble/post-quantum ã§ kyber768.keygen()ã€‚å…¬é–‹éµã‚’ã‚µãƒ¼ãƒé€ä¿¡ã€‚ç§˜å¯†éµã‚’ IndexedDB ä¿å­˜ã€‚', api:'POST /auth/register', screen:'/register' },
      { id:'F-14', title:'TOTP 2FA å…¥åŠ›ç”»é¢', detail:'6æ¡ OTP å…¥åŠ› UIã€‚å¤±æ•—æ™‚ã‚¨ãƒ©ãƒ¼ãƒ»ãƒ­ãƒƒã‚¯æ®‹å›æ•°è¡¨ç¤ºã€‚verifyTotp â†’ auth_token å–å¾—ã€‚', api:'POST /auth/totp/verify', screen:'ãƒ¢ãƒ¼ãƒ€ãƒ«' },
      { id:'F-15', title:'Protected Route ã‚¬ãƒ¼ãƒ‰', detail:'JWT ãªã— â†’ /login ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã€‚role: admin ã§ã®ã¿ /admin ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã€‚', api:'â€”', screen:'å…¨ç”»é¢' },
    ]},
  { id:'P2', label:'Phase 2', name:'ãƒ•ã‚¡ã‚¤ãƒ«é€ä¿¡ç”»é¢ (SCREEN 1)', badge:'#4338ca', bg:'#eef2ff', border:'#c7d2fe', textColor:'#3730a3',
    tasks:[
      { id:'F-16', title:'3ã‚¹ãƒ†ãƒƒãƒ—é€²æ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼', detail:'â‘ ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ â†’ â‘¡å—ä¿¡è€…è¨­å®š â†’ â‘¢é€ä¿¡ç¢ºèªã€‚step state ç®¡ç†ã€‚', api:'â€”', screen:'/' },
      { id:'F-17', title:'ãƒ‰ãƒ©ãƒƒã‚° & ãƒ‰ãƒ­ãƒƒãƒ— ã‚¾ãƒ¼ãƒ³', detail:'react-dropzoneã€‚æœ€å¤§ 1GB ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€‚é¸æŠå¾Œã‚µãƒ ãƒã‚¤ãƒ«ãƒ»ã‚µã‚¤ã‚ºãƒ»ç¨®åˆ¥è¡¨ç¤ºã€‚', api:'â€”', screen:'/' },
      { id:'F-18', title:'å—ä¿¡è€…ãƒ¡ãƒ¼ãƒ«å…¥åŠ› + Kyber éµãƒãƒƒã‚¸', detail:'ãƒ¡ãƒ¼ãƒ«å…¥åŠ› â†’ API ã§å—ä¿¡è€…å…¬é–‹éµæ¤œç´¢ã€‚ã€ŒğŸ”‘ Kyberéµã‚ã‚Šã€ãƒãƒƒã‚¸è¡¨ç¤ºã€‚ã‚¿ã‚°å½¢å¼ UIã€‚', api:'POST /transfer/initiate', screen:'/' },
      { id:'F-19', title:'ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸é¸æŠ UI', detail:'Box / Google Drive / OneDrive / Dropbox ã®ã‚°ãƒªãƒƒãƒ‰é¸æŠã€‚', api:'â€”', screen:'/' },
      { id:'F-20', title:'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šãƒ‘ãƒãƒ«', detail:'URLæœ‰åŠ¹æœŸé™ (1h/6h/12h/24h)ãƒ»æœ€å¤§DLå›æ•° (1/2/3/5)ãƒ»FIDO2 2FA ãƒˆã‚°ãƒ«ã€‚å¸¸æ™‚ONé …ç›®ã®è¡¨ç¤ºã€‚', api:'â€”', screen:'/' },
      { id:'F-21', title:'åˆ†å‰²ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ ãƒˆã‚°ãƒ«', detail:'ONæ™‚ã¯ split-parts API ãƒ•ãƒ­ãƒ¼ã¸åˆ‡ã‚Šæ›¿ãˆã€‚', api:'POST /transfer/:id/split-parts', screen:'/' },
      { id:'F-22', title:'ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ AES-256-GCM æš—å·åŒ– â­', detail:'Web Crypto API: crypto.subtle.generateKey(AES-GCM) â†’ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§æš—å·åŒ–ã€‚', api:'â€”', screen:'/' },
      { id:'F-23', title:'ML-KEM-768 éµã‚«ãƒ—ã‚»ãƒ«åŒ– (é€ä¿¡è€…å´) â­', detail:'@noble/post-quantum: kyber768.encapsulate(recipientPublicKey) â†’ AESéµã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–ã€‚', api:'â€”', screen:'/' },
      { id:'F-24', title:'é€ä¿¡APIãƒ•ãƒ­ãƒ¼ (3ã‚¹ãƒ†ãƒƒãƒ—)', detail:'â‘  POST /transfer/initiate â†’ â‘¡ PUT æš—å·åŒ–ãƒ•ã‚¡ã‚¤ãƒ« to SignedURL â†’ â‘¢ POST /transfer/:id/keyã€‚', api:'POST /transfer/initiate,key', screen:'/' },
      { id:'F-25', title:'é€ä¿¡é€²æ—ãƒãƒ¼ & ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³', detail:'æš—å·åŒ–ä¸­ãƒ»ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­ã®é€²æ—ã‚’ progress-bar ã§è¡¨ç¤ºã€‚ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å†ç¾ã€‚', api:'â€”', screen:'/' },
      { id:'F-26', title:'é€ä¿¡å®Œäº†ç”»é¢ (ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ URL + QRã‚³ãƒ¼ãƒ‰)', detail:'ç”Ÿæˆ URL è¡¨ç¤ºãƒ»ã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³ãƒ»qrcode.react ã§ QR ç”Ÿæˆã€‚ã€Œã‚µãƒ¼ãƒã«ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¿æŒã•ã‚Œã¾ã›ã‚“ã€è¡¨ç¤ºã€‚', api:'â€”', screen:'/' },
    ]},
  { id:'P3', label:'Phase 3', name:'é€ä¿¡å±¥æ­´ç”»é¢ (SCREEN 2)', badge:'#1d4ed8', bg:'#eff6ff', border:'#bfdbfe', textColor:'#1e3a8a',
    tasks:[
      { id:'F-27', title:'é€ä¿¡ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ãƒšãƒ¼ã‚¸ (ã‚«ãƒ¼ãƒ‰ã‚°ãƒªãƒƒãƒ‰)', detail:'4ã‚«ãƒ©ãƒ ã‚°ãƒªãƒƒãƒ‰ã€‚thumb-gradient ã‚µãƒ ãƒã‚¤ãƒ«ãƒ»æš—å·åŒ–æ¸ˆã¿ãƒãƒƒã‚¸ã€‚', api:'GET /admin/sessions', screen:'/list' },
      { id:'F-28', title:'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚¿ãƒ–', detail:'ã™ã¹ã¦ãƒ»æœ‰åŠ¹ãƒ»æœŸé™åˆ‡ã‚Œãƒ»å‰Šé™¤æ¸ˆã¿ã®4ã‚¿ãƒ–ã€‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ¥å–å¾—ã€‚', api:'GET /admin/sessions?status=', screen:'/list' },
      { id:'F-29', title:'ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢', detail:'å—ä¿¡è€…ãƒ¡ãƒ¼ãƒ«ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«åã§ãƒ‡ãƒã‚¦ãƒ³ã‚¹æ¤œç´¢ (300ms)ã€‚', api:'GET /admin/sessions?q=', screen:'/list' },
      { id:'F-30', title:'æœ‰åŠ¹æœŸé™ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒãƒ¼', detail:'å„ã‚«ãƒ¼ãƒ‰ã«ã€Œæ®‹ Xhã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã€‚æœŸé™åˆ‡ã‚Œã¯èµ¤è‰²ã«å¤‰åŒ–ã€‚', api:'â€”', screen:'/list' },
      { id:'F-31', title:'ã‚»ãƒƒã‚·ãƒ§ãƒ³è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ«', detail:'ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±ãƒ»DLå›æ•°ãƒ»ç›£æŸ»ãƒ­ã‚°è¡¨ç¤ºã€‚ãƒ•ã‚©ãƒ¼ã‚¹ãƒ‡ãƒªãƒ¼ãƒˆãƒœã‚¿ãƒ³ä»˜ãã€‚', api:'GET /admin/sessions/:id', screen:'/list ãƒ¢ãƒ¼ãƒ€ãƒ«' },
      { id:'F-32', title:'å¼·åˆ¶å‰Šé™¤ (ãƒ•ã‚©ãƒ¼ã‚¹ãƒ‡ãƒªãƒ¼ãƒˆ)', detail:'ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚° â†’ DELETE â†’ æ¥½è¦³çš„æ›´æ–°ã§ãƒªã‚¹ãƒˆé™¤å»ã€‚', api:'DELETE /admin/sessions/:id', screen:'/list' },
    ]},
  { id:'P4', label:'Phase 4', name:'å—ä¿¡è€…ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç”»é¢ (SCREEN 3)', badge:'#047857', bg:'#f0fdf4', border:'#a7f3d0', textColor:'#064e3b',
    tasks:[
      { id:'F-33', title:'ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ (URLãƒˆãƒ¼ã‚¯ãƒ³è§£æ)', detail:'/download/:token â†’ GET /download/:token ã§ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±å–å¾—ãƒ»è¡¨ç¤ºã€‚æœ‰åŠ¹æœŸé™ãƒ»DLæ®‹å›æ•°ã€‚', api:'GET /download/:token', screen:'/download/:token' },
      { id:'F-34', title:'2FA èªè¨¼ UI (TOTP / FIDO2 é¸æŠ)', detail:'ç”Ÿä½“èªè¨¼/FIDO2 ã¨ TOTP ã®2æŠã€‚ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹è¡¨ç¤ºã€‚', api:'â€”', screen:'/download/:token' },
      { id:'F-35', title:'TOTP æ¤œè¨¼ â†’ auth_token å–å¾—', detail:'6æ¡å…¥åŠ› â†’ POST /auth/totp/verify â†’ auth_token ã‚’ä¸€æ™‚ä¿å­˜ã€‚å¤±æ•—ã‚«ã‚¦ãƒ³ãƒˆè¡¨ç¤ºã€‚', api:'POST /auth/totp/verify', screen:'/download/:token' },
      { id:'F-36', title:'æš—å·åŒ– AES éµå–å¾—', detail:'GET /download/:token/key (Bearer auth_token) â†’ encapsulated_key_b64 å–å¾—ã€‚', api:'GET /download/:token/key', screen:'/download/:token' },
      { id:'F-37', title:'IndexedDB ã‹ã‚‰ Kyber ç§˜å¯†éµå–å¾—', detail:'userId ã‚’ã‚­ãƒ¼ã« IndexedDB ã‹ã‚‰ç§˜å¯†éµã‚’å–å¾—ã€‚éµãªã—æ™‚ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã€‚', api:'â€”', screen:'/download/:token' },
      { id:'F-38', title:'ML-KEM-768 è„±ã‚«ãƒ—ã‚»ãƒ«åŒ– + AES å¾©å· â­', detail:'kyber768.decapsulate(encKey, privateKey) â†’ AESéµå¾©å…ƒ â†’ crypto.subtle.decrypt() ã§ãƒ•ã‚¡ã‚¤ãƒ«å¾©å·ã€‚', api:'â€”', screen:'/download/:token' },
      { id:'F-39', title:'å¾©å·ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ + å®Œäº†é€šçŸ¥', detail:'Blob URL ã§ãƒ–ãƒ©ã‚¦ã‚¶ DL é–‹å§‹ â†’ POST /download/:token/complete â†’ è‡ªå‹•å‰Šé™¤ç¢ºèªè¡¨ç¤ºã€‚', api:'POST /download/:token/complete', screen:'/download/:token' },
    ]},
  { id:'P5', label:'Phase 5', name:'ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ (SCREEN 4)', badge:'#c2410c', bg:'#fff7ed', border:'#fed7aa', textColor:'#7c2d12',
    tasks:[
      { id:'F-40', title:'ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ', detail:'ã‚µã‚¤ãƒ‰ãƒãƒ¼ä»˜ã: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ãƒ»ç›£æŸ»ãƒ­ã‚°ã®3ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã€‚', api:'â€”', screen:'/admin' },
      { id:'F-41', title:'ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§ (ç®¡ç†è€…)', detail:'ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ä»˜ããƒ†ãƒ¼ãƒ–ãƒ«: IDãƒ»å—ä¿¡è€…ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ»é€ä¿¡æ—¥æ™‚ãƒ»æ“ä½œã€‚', api:'GET /admin/sessions', screen:'/admin' },
      { id:'F-42', title:'ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ãƒ†ãƒ¼ãƒ–ãƒ«', detail:'ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ (è¡¨ç¤ºåãƒ»ãƒ­ãƒ¼ãƒ«ãƒ»ä½œæˆæ—¥ãƒ»æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³)ã€‚å‰Šé™¤ãƒœã‚¿ãƒ³ä»˜ãã€‚', api:'GET /admin/users, DELETE /admin/users/:id', screen:'/admin' },
      { id:'F-43', title:'ç›£æŸ»ãƒ­ã‚°ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼', detail:'ã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥ãƒ»çµæœãƒ»IPã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ»æ—¥æ™‚ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã€‚CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒœã‚¿ãƒ³ã€‚', api:'GET /admin/logs, GET /admin/logs/export', screen:'/admin' },
    ]},
  { id:'P6', label:'Phase 6', name:'å“è³ªãƒ»ä»•ä¸Šã’', badge:'#9d174d', bg:'#fdf2f8', border:'#f9a8d4', textColor:'#831843',
    tasks:[
      { id:'F-44', title:'ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°çµ±ä¸€', detail:'APIãƒ»æš—å·åŒ–ãƒ»éµãªã—ã‚¨ãƒ©ãƒ¼ã‚’ toast é€šçŸ¥ã§çµ±ä¸€ã€‚å…¨ç”»é¢å…±é€šã€‚', api:'â€”', screen:'å…¨ç”»é¢' },
      { id:'F-45', title:'ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ»ã‚¹ã‚±ãƒ«ãƒˆãƒ³ UI', detail:'å…¨ API å‘¼ã³å‡ºã—ã« Suspense / ã‚¹ã‚±ãƒ«ãƒˆãƒ³ã‚«ãƒ¼ãƒ‰é©ç”¨ã€‚fade-in-up å†ç¾ã€‚', api:'â€”', screen:'å…¨ç”»é¢' },
      { id:'F-46', title:'ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ', detail:'ãƒ¢ãƒã‚¤ãƒ« (sm:) / ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ (md:) / ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ— (lg:) 3ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆå¯¾å¿œã€‚', api:'â€”', screen:'å…¨ç”»é¢' },
      { id:'F-47', title:'E2E å‹•ä½œç¢ºèª (å…¨ãƒ•ãƒ­ãƒ¼é€šã—)', detail:'register â†’ login â†’ send â†’ receive ã®å…¨ãƒ•ãƒ­ãƒ¼ã‚’ Playwright ã¾ãŸã¯æ‰‹å‹•ã§ç¢ºèªã€‚', api:'å…¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ', screen:'å…¨ç”»é¢' },
      { id:'F-48', title:'docker-compose ã« frontend ã‚µãƒ¼ãƒ“ã‚¹è¿½åŠ ', detail:'Vite dev server ã‚’ docker-compose.yml ã«è¿½åŠ ã€‚æœ¬ç•ªã¯ nginx ã‚³ãƒ³ãƒ†ãƒŠã§é…ä¿¡ã€‚', api:'â€”', screen:'â€”' },
    ]},
];

// â”€â”€ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚­ãƒ¼ â”€â”€
const STORE_KEY = 'zerosend-frontend-progress-v1';

// â”€â”€ çŠ¶æ…‹ â”€â”€
let statuses = {};
let openPhases = {};
let currentFilter = 'all';

function loadState() {
  try {
    const s = JSON.parse(localStorage.getItem(STORE_KEY) || '{}');
    statuses = s.statuses || {};
    openPhases = s.openPhases || {};
  } catch(e) {}
  // åˆæœŸå€¤è£œå®Œ
  PHASES.forEach(p => p.tasks.forEach(t => {
    if (!statuses[t.id]) statuses[t.id] = 'æœªç€æ‰‹';
  }));
  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼šå…¨ãƒ•ã‚§ãƒ¼ã‚ºå±•é–‹
  PHASES.forEach(p => {
    if (openPhases[p.id] === undefined) openPhases[p.id] = true;
  });
}

function saveState() {
  localStorage.setItem(STORE_KEY, JSON.stringify({ statuses, openPhases }));
  showToast();
}

let toastTimer;
function showToast() {
  const el = document.getElementById('toast');
  el.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => el.classList.remove('show'), 1400);
}

// â”€â”€ çµ±è¨ˆ â”€â”€
function calcStats() {
  const all = Object.values(statuses);
  const done = all.filter(s => s === 'å®Œäº†').length;
  const wip  = all.filter(s => s === 'é€²è¡Œä¸­').length;
  const total = all.length;
  return { done, wip, total, pct: Math.round(done / total * 100) };
}

function updateHeader() {
  const { done, wip, total, pct } = calcStats();
  document.getElementById('pct-display').textContent = pct + '%';
  document.getElementById('stat-label').textContent = `${done}/${total} å®Œäº† Â· é€²è¡Œä¸­ ${wip}`;
  document.getElementById('global-bar').style.width = pct + '%';
}

// â”€â”€ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ â”€â”€
function setFilter(btn, filter) {
  currentFilter = filter;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderAll();
}

// â”€â”€ ãƒ•ã‚§ãƒ¼ã‚ºé–‹é–‰ â”€â”€
function togglePhase(phaseId) {
  openPhases[phaseId] = !openPhases[phaseId];
  saveState();
  renderAll();
}

// â”€â”€ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ â”€â”€
function changeStatus(taskId, val) {
  statuses[taskId] = val;
  saveState();
  updateHeader();
  renderAll(); // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ã®ãŸã‚å†æç”»
}

function statusClass(s) {
  return s === 'å®Œäº†' ? 'status-done' : s === 'é€²è¡Œä¸­' ? 'status-wip' : s === 'ä¿ç•™' ? 'status-hold' : 'status-todo';
}

// â”€â”€ æç”» â”€â”€
function renderAll() {
  const main = document.getElementById('main');
  let html = '';

  PHASES.forEach(phase => {
    const filteredTasks = currentFilter === 'all'
      ? phase.tasks
      : phase.tasks.filter(t => statuses[t.id] === currentFilter);
    if (filteredTasks.length === 0) return;

    const phaseDone  = phase.tasks.filter(t => statuses[t.id] === 'å®Œäº†').length;
    const phaseTotal = phase.tasks.length;
    const phasePct   = Math.round(phaseDone / phaseTotal * 100);
    const isOpen     = openPhases[phase.id];

    html += `
    <div class="phase" style="border-color:${phase.border}; background:${phase.bg}">
      <div class="phase-header" onclick="togglePhase('${phase.id}')">
        <div class="phase-left">
          <span class="phase-badge" style="background:${phase.badge}">${phase.label}</span>
          <span class="phase-name" style="color:${phase.textColor}">${phase.name}</span>
          <span class="phase-count" style="color:${phase.textColor}; opacity:0.6">${phaseDone}/${phaseTotal}</span>
        </div>
        <div class="phase-right">
          <div class="phase-mini-bar">
            <div class="phase-mini-fill" style="width:${phasePct}%; background:${phase.badge}"></div>
          </div>
          <span class="chevron ${isOpen ? 'open' : ''}">â–¼</span>
        </div>
      </div>`;

    if (isOpen) {
      html += `
      <div class="phase-body">
        <table class="phase-table">
          <thead><tr>
            <th class="col-id">ID</th>
            <th class="col-title">ã‚¿ã‚¹ã‚¯å</th>
            <th class="col-detail">è©³ç´°ãƒ»å®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ</th>
            <th class="col-api">å¯¾å¿œ API</th>
            <th class="col-screen">ç”»é¢</th>
            <th class="col-status">çŠ¶æ…‹</th>
          </tr></thead>
          <tbody>`;

      filteredTasks.forEach(task => {
        const s = statuses[task.id];
        html += `
          <tr>
            <td><span class="task-id">${task.id}</span></td>
            <td><span class="task-title">${task.title}</span></td>
            <td><span class="task-detail">${task.detail}</span></td>
            <td><span class="task-api">${task.api}</span></td>
            <td><span class="task-screen">${task.screen}</span></td>
            <td>
              <select class="status-select ${statusClass(s)}"
                onchange="changeStatus('${task.id}', this.value)"
                onclick="event.stopPropagation()">
                <option value="æœªç€æ‰‹" ${s==='æœªç€æ‰‹'?'selected':''}>æœªç€æ‰‹</option>
                <option value="é€²è¡Œä¸­" ${s==='é€²è¡Œä¸­'?'selected':''}>é€²è¡Œä¸­</option>
                <option value="å®Œäº†"   ${s==='å®Œäº†'  ?'selected':''}>å®Œäº†</option>
                <option value="ä¿ç•™"   ${s==='ä¿ç•™'  ?'selected':''}>ä¿ç•™</option>
              </select>
            </td>
          </tr>`;
      });

      html += `</tbody></table></div>`;
    }

    html += `</div>`;
  });

  // æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
  html += `
  <div class="stack-card">
    <h2>ğŸ“¦ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯</h2>
    <div class="stack-grid">
      ${[
        ['ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯','React 19 + Vite + TypeScript'],
        ['ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°','React Router v7'],
        ['çŠ¶æ…‹ç®¡ç†','Zustand'],
        ['ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹','TanStack Query v5'],
        ['UI','shadcn/ui + Tailwind CSS v4'],
        ['ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰','react-dropzone'],
        ['é‡å­è€æ€§æš—å· (ML-KEM-768)','@noble/post-quantum'],
        ['å¯¾ç§°æš—å· (AES-256-GCM)','Web Crypto API (native)'],
        ['éµæ°¸ç¶šåŒ–','IndexedDB (idb-keyval)'],
        ['HTTP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ','ky'],
        ['QR ã‚³ãƒ¼ãƒ‰','qrcode.react'],
        ['ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼','pnpm'],
      ].map(([k,v])=>`<div class="stack-item"><span class="stack-key">${k}:</span><span class="stack-val">${v}</span></div>`).join('')}
    </div>
  </div>
  <div class="security-card">
    <h3>âš ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆä¸Šã®é‡è¦äº‹é …ï¼ˆâ­ ãƒãƒ¼ã‚¯ = æœ€é‡è¦å®Ÿè£…ï¼‰</h3>
    <ul>
      <li>Kyber ç§˜å¯†éµã¯ <strong>IndexedDB ã®ã¿</strong>ã«ä¿å­˜ã€‚ã‚µãƒ¼ãƒã«ã¯ä¸€åˆ‡é€ä¿¡ã—ãªã„ã€‚</li>
      <li>AES éµã®ç”Ÿæˆãƒ»æš—å·åŒ–ãƒ»å¾©å·ã¯ <strong>å…¨ã¦ãƒ–ãƒ©ã‚¦ã‚¶å†…</strong>ã§å®Œçµã™ã‚‹ã€‚</li>
      <li>ã‚µãƒ¼ãƒãƒ¼ã¯ã‚«ãƒ—ã‚»ãƒ«åŒ–æ¸ˆã¿ AES éµã®ã¿ä¿æŒã€‚å¹³æ–‡éµãƒ»ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã¯ä¿æŒã—ãªã„ã€‚</li>
      <li>F-22ã€œF-23 (é€ä¿¡å´æš—å·åŒ–) ã¨ F-37ã€œF-38 (å—ä¿¡å´å¾©å·) ãŒã‚¼ãƒ­ä¿æŒè¨­è¨ˆã®æ ¸å¿ƒã€‚</li>
    </ul>
  </div>`;

  main.innerHTML = html;
}

// â”€â”€ åˆæœŸåŒ– â”€â”€
loadState();
renderAll();
updateHeader();
</script>
</body>
</html>
